<!DOCTYPE html>
<html lang="en">
  <head>
    <title>TraderChart  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="TraderChart  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">TraderChart Docs</a> (78% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">TraderChart Reference</a>
        <img id="carat" src="img/carat.png" />
        TraderChart  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/AreaSeparator.html">AreaSeparator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BarChartDrawer.html">BarChartDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BollingerBand.html">BollingerBand</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BollingerBand/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BollingerBandCalculator.html">BollingerBandCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BollingerBandCalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Candle.html">Candle</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ChartBorder.html">ChartBorder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ChartData.html">ChartData</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ChartDrawingContext.html">ChartDrawingContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ChartView.html">ChartView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ColorConfig.html">ColorConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ColorText.html">ColorText</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DMIADX.html">DMIADX</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DMIADX/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DMICalculator.html">DMICalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DMICalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DefaultFontContext.html">DefaultFontContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/EMA.html">EMA</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/EMA/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/EMACalculator.html">EMACalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/EnvelopeCalculator.html">EnvelopeCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/FillingAreaDrawer.html">FillingAreaDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GraphArea.html">GraphArea</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Ichimoku.html">Ichimoku</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Ichimoku/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/IchimokuCalculator.html">IchimokuCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/IchimokuCalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Legend.html">Legend</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/LegendDrawer.html">LegendDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/LineChartDrawer.html">LineChartDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MACD.html">MACD</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MACD/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MACDCalculator.html">MACDCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MACDCalculator/SignalType.html">– SignalType</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MACDCalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NumberArray.html">NumberArray</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ParabolicSARCalculator.html">ParabolicSARCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PinchInOut.html">PinchInOut</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PriceLine.html">PriceLine</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PriceMarker.html">PriceMarker</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PsychologicalCalculator.html">PsychologicalCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RCI.html">RCI</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RCI/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RCICalculator.html">RCICalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RSI.html">RSI</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RSI/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RSICalculator.html">RSICalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RSICalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SMA.html">SMA</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SMA/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SMACalculator.html">SMACalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Scroller.html">Scroller</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Scroller/Direction.html">– Direction</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SimpleTechnicalChart.html">SimpleTechnicalChart</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SpanModelCalculator.html">SpanModelCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/StickChartDrawer.html">StickChartDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Stochastics.html">Stochastics</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Stochastics/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/StochasticsCalculator.html">StochasticsCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/StochasticsCalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/s:11TraderChart24SuperBollingerCalculatorC">SuperBollingerCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TimeMarker.html">TimeMarker</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TraderChartView.html">TraderChartView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TurningPoint.html">TurningPoint</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TurningPoint/Param.html">– Param</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TurningPointCalculator.html">TurningPointCalculator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TurningPointCalculator/PointType.html">– PointType</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TurningPointCalculator/TurningPoint.html">– TurningPoint</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TurningPointCalculator/Results.html">– Results</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Volume.html">Volume</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/XAxis.html">XAxis</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/YAxis.html">YAxis</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/YAxis/GraduationAlignment.html">– GraduationAlignment</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/YAxisSetting.html">YAxisSetting</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/MainChartItem.html">MainChartItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SubChartItem.html">SubChartItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/YAxisAlignment.html">YAxisAlignment</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/CGContext.html">CGContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSDecimalNumber.html">NSDecimalNumber</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/ChartDrawer.html">ChartDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ChartItem.html">ChartItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ColorConfigurable.html">ColorConfigurable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/FontContext.html">FontContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/GraphAreaDrawer.html">GraphAreaDrawer</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/TechnicalChart.html">TechnicalChart</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/UsesFontContext.html">UsesFontContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/XAxisMarker.html">XAxisMarker</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/YAxisMarker.html">YAxisMarker</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/ChartRecord.html">ChartRecord</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='traderchart' class='heading'>TraderChart</h1>
<h1 id='' class='heading'>サポート環境</h1>

<ul>
<li>iOS 10.0以上</li>
</ul>
<h1 id='' class='heading'>導入手順</h1>
<h3 id='' class='heading'>プロジェクトにフレームワークを追加する</h3>

<ul>
<li>Xcodeプロジェクトをクリックしプロジェクト設定の <strong>General</strong> タブを表示してください。</li>
</ul>

<p><img src="../Image/install_1.png" alt="SS1">  </p>

<ul>
<li><strong>TraderChart.framework</strong>を<strong>Embedded Binaries</strong>にドラッグ＆ドロップしてください。このとき、<strong>Copy items if needed</strong> にチェックが入っていることを確認してから <strong>Finish</strong> をクリックしてください。<br>
複数Build Targetがある場合は、最初のBuild Targetにframeworkをドラッグ＆ドロップした後、残りのBuild Targetは<strong>Embedded Binaries</strong>の+ボタンからframeworkを追加します。</li>
</ul>

<p><img src="../Image/install_2.png" alt="SS2">
<img src="../Image/install_3.png" alt="SS3"></p>

<ul>
<li>アプリケーションのターゲットの <strong>Build Phases</strong> タブで <strong>Run Script Phase</strong> を末尾に追加し、以下のスクリプトをコピー＆ペーストしてください。</li>
</ul>
<pre class="highlight shell"><code>bash <span class="s2">"</span><span class="k">${</span><span class="nv">BUILT_PRODUCTS_DIR</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">FRAMEWORKS_FOLDER_PATH</span><span class="k">}</span><span class="s2">/TraderChart.framework/strip-frameworks.sh"</span>
</code></pre>

<p>この手順は、ユニバーサルバイナリをアーカイブする時に<a href="http://www.openradar.me/radar?id=6409498411401216">AppStoreへの申請時のバグ</a> を回避するために必要になります。</p>

<p><img src="../Image/install_4.png" alt="SS4">
<img src="../Image/install_5.png" alt="SS5"></p>
<h3 id='' class='heading'>フレームワークをインポートする</h3>

<p>TraderChartをコードから利用するためには、TraderChartを利用する各ソースファイルの先頭に <strong>import TraderChart</strong> を記述してください。</p>

<p><img src="../Image/install_6.png" alt="SS6"></p>
<h1 id='' class='heading'>プログラミングガイド</h1>
<h2 id='chartview' class='heading'>ChartViewクラス</h2>

<p>本ライブラリでチャートを表示する場合、<code><a href="Classes/ChartView.html">ChartView</a></code> または <code><a href="Classes/TraderChartView.html">TraderChartView</a></code>どちらかのViewクラスを使います。<br>
これらのViewクラスは xib や storyboard に配置しても、プログラムで動的に生成してもどちらでも使うことができます。</p>
<h3 id='code-chartview-code' class='heading'><code><a href="Classes/ChartView.html">ChartView</a></code></h3>

<p>チャート描画の基本的な枠組みを提供します。<br>
ライブラリに組み込まれたチャート以外の独自のチャートを表示したい場合は、このクラスを使ってカスタマイズを行います。</p>
<h3 id='code-traderchartview-code' class='heading'><code><a href="Classes/TraderChartView.html">TraderChartView</a></code></h3>

<p><code><a href="Classes/ChartView.html">ChartView</a></code> を継承し、チャート描画の基本的な枠組みに加え、金融商品のチャートでよく使われるテクニカル指標を提供します。<br>
金融商品向けチャートでは多くの場合こちらのクラスを使うことになり、以下のプログラミングガイドは主に<code><a href="Classes/TraderChartView.html">TraderChartView</a></code> を使用する前提での説明になっています。</p>
<h2 id='' class='heading'>最小構成のローソク足表示サンプル</h2>

<p>以下は <code>IBOutlet</code> に設定した <code><a href="Classes/TraderChartView.html">TraderChartView</a></code> にローソク足を表示するの最小構成のコードサンプルです。</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">TraderChart</span>
<span class="kd">class</span> <span class="kt">MinimumSampleViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">chartView</span><span class="p">:</span> <span class="kt">TraderChartView</span><span class="o">!</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="kt">ChartData</span><span class="p">(</span><span class="nv">timeList</span><span class="p">:</span> <span class="p">[</span><span class="s">"1"</span><span class="p">,</span> <span class="s">"2"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">],</span>
                             <span class="nv">openList</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">97</span><span class="p">],</span>
                             <span class="nv">highList</span><span class="p">:</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                             <span class="nv">lowList</span><span class="p">:</span>  <span class="p">[</span> <span class="mi">95</span><span class="p">,</span>  <span class="mi">95</span><span class="p">,</span>  <span class="mi">87</span><span class="p">],</span>
                             <span class="nv">closeList</span><span class="p">:[</span><span class="mi">105</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">92</span><span class="p">])</span>
        <span class="n">chartView</span><span class="o">.</span><span class="nf">addData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>

<p><code><a href="Classes/TraderChartView.html">TraderChartView</a></code> は初期状態でローソク足を表示するようになっており、そこに日時と四本値（始値、高値、安値、終値）の情報を持った<code><a href="Classes/ChartData.html">ChartData</a></code>をセットするとローソク足が表示されます。  </p>

<p>上記のサンプルでは固定値で<code><a href="Classes/ChartData.html">ChartData</a></code>を作成していますが、実際にはAPIなどから取得した四本値データから <code><a href="Classes/ChartData.html">ChartData</a></code> を構築する必要があります。</p>
<h2 id='chartdata' class='heading'>ChartData</h2>

<p>チャートのデータは <code><a href="Classes/ChartData.html">ChartData</a></code> クラスのインスタンスとして <code><a href="Classes/ChartView.html">ChartView</a></code> に引き渡します。</p>

<p><code><a href="Classes/ChartData.html">ChartData</a></code> は日時と四本値（始値、高値、安値、終値）に加えて、出来高、VWAP、シーケンスナンバーの情報を持つことができますが、このうち必須の情報は日時と終値の２つのみです。</p>

<p>ローソク足を描画する場合は四本値の情報が必要になりますが、Tickチャートなどのラインチャートを描画する場合は日時と終値の情報だけでチャートが表示可能です。</p>
<h3 id='' class='heading'>日時</h3>

<p><code><a href="Classes/ChartData.html">ChartData</a></code> クラスの <code>timeList</code> に設定した配列はチャートのX軸の目盛りテキストおよび、データをマージ（結合）する際の前後関係（順序）の判定に使われます。</p>

<p><code>timeList</code> の要素には任意の文字列を設定可能ですが、後述するデータのマージ（結合）を行う場合は <code>timeList</code> の各要素を比較してデータの前後関係（順序）を判定するため、順番が分かる文字列である必要があります。</p>
<h3 id='' class='heading'>データのマージ</h3>

<p><code><a href="Classes/ChartData.html">ChartData</a></code> は最初に取得したデータに対して、差分データを保持する別インスタンスをマージ（統合）することができます。
以下は、1時、2時、3時の3レコードに対して、新しい3時、4時のデータをマージするコードの例です。</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="kt">ChartData</span><span class="p">(</span><span class="nv">timeList</span><span class="p">:</span> <span class="p">[</span><span class="s">"1"</span><span class="p">,</span> <span class="s">"2"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">],</span>
                     <span class="nv">closeList</span><span class="p">:[</span><span class="mi">100</span><span class="p">,</span>  <span class="mi">101</span><span class="p">,</span>  <span class="mi">102</span><span class="p">])</span>

<span class="k">let</span> <span class="nv">additionalData</span> <span class="o">=</span> <span class="kt">ChartData</span><span class="p">(</span><span class="nv">timeList</span><span class="p">:</span> <span class="p">[</span><span class="s">"3"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">],</span>
                               <span class="nv">closeList</span><span class="p">:[</span><span class="mi">103</span><span class="p">,</span>  <span class="mi">104</span><span class="p">])</span>

<span class="n">data</span><span class="o">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">additionalData</span><span class="p">)</span>
</code></pre>

<p>最初のデータ</p>

<table><thead>
<tr>
<th>1時</th>
<th>2時</th>
<th>3時</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>101</td>
<td>102</td>
</tr>
</tbody></table>

<p>マージ後のデータ</p>

<table><thead>
<tr>
<th>1時</th>
<th>2時</th>
<th>3時</th>
<th>4時</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td>101</td>
<td><strong>103</strong></td>
<td><strong>104</strong></td>
</tr>
</tbody></table>

<p>マージ後は3時、4時の数値が <code>additionalData</code> の持つ103、104に更新されます。</p>
<h3 id='' class='heading'>マージの際の前後関係（順序）の判定</h3>

<p><code><a href="Classes/ChartData.html">ChartData</a></code> をマージする際、正しい位置にデータを追加するため各データの順序を判定する必要がありますが、順序の判定は標準では<code>timeList</code> の要素を比較して行われます。</p>

<p>標準では <code>timeList</code> の要素は64ビットの整数値(Int64)に変換して順序が比較されますが、<code>timeList</code> の要素が整数値に変換できないフォーマットの場合は、<code><a href="Classes/ChartData.html">ChartData</a></code> のイニシャライザで順序を比較するための関数を設定しておく必要があります。</p>

<p>以下のコードは<code>timeList</code> の要素が <code>?時</code> の形式の文字列になっており、<code>時</code>の文字を取り除いた上での数値比較で順序を判定する例です。</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">mergeData</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="kt">ChartData</span><span class="p">(</span><span class="nv">timeList</span><span class="p">:</span> <span class="p">[</span><span class="s">"1時"</span><span class="p">,</span> <span class="s">"2時"</span><span class="p">,</span> <span class="s">"3時"</span><span class="p">],</span>
                         <span class="nv">closeList</span><span class="p">:[</span><span class="mi">100</span><span class="p">,</span>  <span class="mi">101</span><span class="p">,</span>  <span class="mi">102</span><span class="p">],</span>
                         <span class="nv">compareTime</span><span class="p">:</span> <span class="n">compareTime</span><span class="p">)</span> <span class="c1">// 日時を比較するための関数 compareTime を渡す</span>

    <span class="k">let</span> <span class="nv">additionalData</span> <span class="o">=</span> <span class="kt">ChartData</span><span class="p">(</span><span class="nv">timeList</span><span class="p">:</span> <span class="p">[</span><span class="s">"3時"</span><span class="p">,</span> <span class="s">"4時"</span><span class="p">],</span>
                                   <span class="nv">closeList</span><span class="p">:[</span><span class="mi">103</span><span class="p">,</span>  <span class="mi">104</span><span class="p">])</span>

    <span class="n">data</span><span class="o">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">additionalData</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// 文字列から "時" を取り除いた上で数値比較する</span>
<span class="kd">func</span> <span class="nf">compareTime</span><span class="p">(</span><span class="nv">time1</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">time2</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">ComparisonResult</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">numberStr1</span> <span class="o">=</span> <span class="n">time1</span><span class="o">.</span><span class="nf">replacingOccurrences</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="s">"時"</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">numberStr2</span> <span class="o">=</span> <span class="n">time2</span><span class="o">.</span><span class="nf">replacingOccurrences</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="s">"時"</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">number1</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">numberStr1</span><span class="p">)</span> <span class="p">??</span> <span class="mi">0</span>
    <span class="k">let</span> <span class="nv">number2</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">numberStr2</span><span class="p">)</span> <span class="p">??</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">number1</span> <span class="o">&lt;</span> <span class="n">number2</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">orderedAscending</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">number1</span> <span class="o">&gt;</span> <span class="n">number2</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">orderedDescending</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="n">orderedSame</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='sequencenumber' class='heading'>sequenceNumber による順序の判定</h3>

<p>Tickチャートなどの場合、同一日時に紐づく価格データが複数発生するケースがあります。<br>
この場合<code>timeList</code>ではデータの順序を判定できないため、<code>timeList</code>とは別にデータの順序を判定するための <code>sequenceNumberList</code> を <code><a href="Classes/ChartData.html">ChartData</a></code> に設定することができます。</p>

<p><code>sequenceNumberList</code> を <code><a href="Classes/ChartData.html">ChartData</a></code> に設定した場合、<code>timeList</code> の代わりに <code>sequenceNumberList</code> によりデータの順序が判定されます。</p>
<h2 id='' class='heading'>グラフ領域</h2>

<p><code><a href="Classes/ChartView.html">ChartView</a></code> は複数のグラフ領域（GraphAreaインスタンス）を持つことができ、それらは縦に並べて表示されます。</p>

<p>全てのグラフ領域は <code><a href="Classes/ChartView.html#/s:11TraderChart0B4ViewC10graphAreasSayAA9GraphAreaCGvp">ChartView.graphAreas</a></code> プロパティで配列として取得でき、また先頭のグラフ領域は <code><a href="Classes/ChartView.html#/s:11TraderChart0B4ViewC13mainGraphAreaAA0eF0Cvp">ChartView.mainGraphArea</a></code>、２つ目以降のグラフ領域は <code><a href="Classes/ChartView.html#/s:11TraderChart0B4ViewC13subGraphAreasSayAA0E4AreaCGvp">ChartView.subGraphAreas</a></code> プロパティでも取得することができます。</p>

<p>各グラフ領域は <code><a href="Classes/GraphArea.html#/s:11TraderChart9GraphAreaC9isVisibleSbvp">GraphArea.isVisible</a></code> プロパティで表示・非表示を切り替えることができます。</p>
<h2 id='' class='heading'>表示するチャート（テクニカル指標など）の切り替え</h2>

<p><code><a href="Classes/TraderChartView.html">TraderChartView</a></code> に表示するチャートの種類は <code>setVisibleMainChartTypes</code> および <code>setVisibleSubChartType</code> function で設定します。</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">setChartTypes</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 表示するメインチャートを指定します（複数指定可能）</span>
    <span class="n">chartView</span><span class="o">.</span><span class="nf">setVisibleMainChartTypes</span><span class="p">([</span><span class="o">.</span><span class="n">candle</span><span class="p">,</span> <span class="o">.</span><span class="n">turningPoint</span><span class="p">])</span>

    <span class="c1">// 表示するサブチャートを指定します（複数指定可能）</span>
    <span class="n">chartView</span><span class="o">.</span><span class="nf">setVisibleSubChartTypes</span><span class="p">([</span><span class="o">.</span><span class="n">macd</span><span class="p">,</span> <span class="o">.</span><span class="n">stochastics</span><span class="p">])</span>
<span class="p">}</span>

</code></pre>

<p>表示するチャートの種類は <code><a href="Enums/MainChartItem.html">MainChartItem</a></code> および <code><a href="Enums/SubChartItem.html">SubChartItem</a></code> の enum 値で指定することができ、それぞれ以下の種類があります。</p>
<h3 id='mainchartitem' class='heading'>メインチャート（MainChartItem）</h3>

<ul>
<li>candle ローソク足</li>
<li>priceLine ラインチャート</li>
<li>sma 単純移動平均</li>
<li>ema 指数平滑移動平均</li>
<li>ichimoku 一目均衡表</li>
<li>bollingerBand ボリンジャーバンド</li>
<li>turningPoint 転換点</li>
</ul>
<h3 id='subchartitem' class='heading'>サブチャート（SubChartItem）</h3>

<ul>
<li>macd MACD</li>
<li>stochastics ストキャスティクス</li>
<li>rsi RSI</li>
<li>rci RCI</li>
<li>dmiAdx DMI/ADX</li>
<li>volume 出来高</li>
</ul>
<h2 id='' class='heading'>レイアウトのカスタマイズ</h2>

<p>ChartViewの各要素のサイズやレイアウトは一般的で見やすい形に初期設定されていますが、個別にカスタマイズすることもできます。<br>
以下はカスタマイズ可能なサイズやレイアウトをプログラムで初期設定する例です。</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">ExampleViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">chartView</span><span class="p">:</span> <span class="kt">TraderChartView</span><span class="o">!</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="c1">// 上下左右の余白を設定します（初期値は全て0）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">margin</span> <span class="o">=</span> <span class="kt">UIEdgeInsets</span><span class="p">(</span><span class="nv">top</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">left</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nv">bottom</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">right</span><span class="p">:</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1">// グラフ領域の上下左右の枠線の太さを設定します（初期値は全て0.5）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">border</span><span class="o">.</span><span class="nf">setWidth</span><span class="p">(</span><span class="nv">left</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nv">right</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nv">top</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nv">bottom</span><span class="p">:</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1">// グラフ領域の区切り線の太さを設定します（初期値は全て0.5）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">separator</span><span class="o">.</span><span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">// 左端のスクロールの余白を設定します（初期値は50）</span>
        <span class="c1">// 左端までスクロールした際グラフの左側にこのサイズ分余白が空きます</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">leftScrollMargin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">// 左側のスクロールの余白を設定します（初期値は50）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">rightScrollMargin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">// 下部X軸（横軸）目盛りの領域の高さを指定します</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="c1">// 下部X軸（横軸）の罫線の太さを設定します（初期値は 0.5）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">// 下部X軸（横軸）の罫線の破線間隔を設定します。nilを指定した場合破線ではなく実線になります。</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">lineDashIntervals</span> <span class="o">=</span> <span class="kc">nil</span>
        <span class="c1">// Y軸（縦軸）目盛りの左右位置を指定します（初期値は .right）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">yAxisSetting</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="o">.</span><span class="n">left</span>
        <span class="c1">// Y軸（縦軸）目盛りの幅を指定します</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">yAxisSetting</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">80</span>
        <span class="c1">// Y軸（縦軸）目盛りをグラフ領域と重ねるかを指定します（初期値は false）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">yAxisSetting</span><span class="o">.</span><span class="n">graphOverwrap</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="c1">// メイングラフ領域のY軸（縦軸）の罫線の表示・非表示を設定します（初期値はtrue）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">isLineVisible</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="c1">// メイングラフ領域のY軸（縦軸）の罫線の太さを設定します（初期値は0.5）</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">// メイングラフ領域のY軸（縦軸）の罫線の破線間隔を設定します。nilを指定した場合破線ではなく実線になります。</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">lineDashIntervals</span> <span class="o">=</span> <span class="kc">nil</span>
        <span class="c1">// メイングラフ領域のY軸（縦軸）目盛りテキストの罫線に対する位置（罫線の上・下・中心）を設定します。</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">graduationAlignment</span> <span class="o">=</span> <span class="o">.</span><span class="n">aboveLine</span>
        <span class="c1">// メイングラフ領域のY軸（縦軸）目盛りテキストのパディングを設定します。</span>
        <span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">textPadding</span> <span class="o">=</span> <span class="mi">6</span>

        <span class="c1">// ※Y軸の設定はメイングラフ領域だけでなく、各グラフ領域に個別に設定することができます</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h2 id='' class='heading'>色の設定</h2>

<p>JSONの設定ファイルでチャートの各種色を設定することができます。</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">colorConfigSample</span><span class="p">(</span><span class="nv">chartView</span><span class="p">:</span> <span class="kt">ChartView</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">chartView</span><span class="o">.</span><span class="n">colorConfig</span> <span class="o">=</span> <span class="kt">ColorConfig</span><span class="p">(</span><span class="nv">filePath</span><span class="p">:</span> <span class="s">"color_config"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h2 id='' class='heading'>フォントの設定</h2>

<p>X軸、Y軸目盛りや転換点などのフォントは個別に指定することができますが、フォントファミリーを一括で指定することもできます。
フォントファミリーを一括で指定する場合は、FontContextを実装したクラスを作り、ChartViewのfontContextに指定します。</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">fontContextSample</span><span class="p">(</span><span class="nv">chartView</span><span class="p">:</span> <span class="kt">ChartView</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">chartView</span><span class="o">.</span><span class="n">fontContext</span> <span class="o">=</span> <span class="kt">SampleFontContext</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">SampleFontContext</span><span class="p">:</span> <span class="kt">FontContext</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">numericFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIFont</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">UIFont</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"American Typewriter"</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="n">size</span><span class="p">)</span> <span class="p">??</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="n">size</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">descriptionFont</span><span class="p">(</span><span class="nv">size</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIFont</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="n">size</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='x' class='heading'>X軸の設定</h2>

<p>X軸は以下の設定をプログラムで行う必要があります。</p>

<ul>
<li>目盛りテキストを表示する位置</li>
<li>罫線を描画する位置</li>
<li>目盛りテキストのフォーマット</li>
</ul>

<p>これらはX軸の間隔や足種別（分足、日足、月足など）によって変わることが一般的なため、動的に設定する必要があります。</p>

<p>これらの設定はそれぞれXAxisの以下のプロパティで行うことができ、<code>XAxis.setup</code> functionでこれらのプロパティをまとめて設定することができます。</p>

<ul>
<li><p>isVisibleText: 判定するレコードのインデックス、日時文字列（ChartData.timeListの要素）、全日時文字列の配列を引数にとり、該当のレコードにX軸目盛りテキストを表示するか判定します</p></li>
<li><p>isVisibleLine:  判定するレコードのインデックス、日時文字列（ChartData.timeListの要素）、全日時文字列の配列を引数にとり、該当のレコードにX軸罫線を表示するか判定します</p></li>
<li><p>formatter: ChartData.timeList の要素をX軸目盛りテキストとして表示する文字列に変換します</p></li>
</ul>

<p>以下のコードサンプルでは <code>isVisibleAxis</code> の判定によりX軸の刻み10本ごとに罫線と目盛りテキストを描画します。</p>

<p>また、目盛りテキストは <code>formatXAxisText</code> により、<q>yyyyMMddHHmm</q> のフォーマットから <q>HH:mm</q> に変換して表示されます。このコードサンプルでは常に同じ変換を行いますが、一般的には現在のX軸の間隔や足種別により、変換方法を変える必要があります。</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">setupXAxis</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">chartView</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="nf">setup</span><span class="p">(</span><span class="nv">formatter</span><span class="p">:</span> <span class="n">formatXAxisText</span><span class="p">,</span> <span class="nv">isVisibleText</span><span class="p">:</span> <span class="n">isVisibleAxis</span><span class="p">,</span> <span class="nv">isVisibleLine</span><span class="p">:</span> <span class="n">isVisibleAxis</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">isVisibleAxis</span><span class="p">(</span><span class="nv">index</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">timeText</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span> <span class="nv">timeList</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">index</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">formatXAxisText</span><span class="p">(</span><span class="nv">index</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">timeText</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">timeText</span> <span class="o">=</span> <span class="n">timeText</span><span class="p">,</span> <span class="n">timeText</span><span class="o">.</span><span class="n">isNotEmpty</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s">""</span> <span class="p">}</span>

    <span class="k">let</span> <span class="nv">inputFormat</span> <span class="o">=</span> <span class="kt">DateFormatter</span><span class="p">()</span>
    <span class="n">inputFormat</span><span class="o">.</span><span class="n">dateFormat</span> <span class="o">=</span> <span class="s">"yyyyMMddHHmm"</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">date</span> <span class="o">=</span> <span class="n">inputFormat</span><span class="o">.</span><span class="nf">date</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">timeText</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">""</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">outputFormat</span> <span class="o">=</span> <span class="kt">DateFormatter</span><span class="p">()</span>
    <span class="n">outputFormat</span><span class="o">.</span><span class="n">dateFormat</span> <span class="o">=</span> <span class="s">"HH:mm"</span>

    <span class="k">return</span> <span class="n">outputFormat</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">date</span><span class="p">)</span>
<span class="p">}</span>

</code></pre>
<h3 id='' class='heading'>タッチマーカーの表示</h3>

<p>初期状態ではX軸をタップするとタップした位置にマーカーが表示されます。</p>

<p><code>ChartView.onRecordSelected</code> プロパティにコールバック関数を設定すると、X軸がタップされたタイミングで任意の処理を実行することができます。</p>

<p>コールバック関数にはタップされた位置のインデックスとチャートデータが引数で渡されます。</p>

<p>以下のコードサンプルはX軸タップ時にタップ位置のインデックスと終値を<code>print</code>関数で出力します。</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="n">chartView</span><span class="o">.</span><span class="n">onRecordSelected</span> <span class="o">=</span> <span class="p">{</span> <span class="n">index</span><span class="p">,</span> <span class="n">chartData</span> <span class="k">in</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">index</span> <span class="o">=</span> <span class="n">index</span><span class="p">,</span> <span class="k">let</span> <span class="nv">close</span> <span class="o">=</span> <span class="n">chartData</span><span class="p">?</span><span class="o">.</span><span class="n">closeList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">index</span><span class="se">)</span><span class="s"> C: </span><span class="se">\(</span><span class="n">close</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='y' class='heading'>Y軸の設定</h2>

<p>Y軸は特別な設定をしなくても表示されますが、多くの場合は表示対象の商品に応じて、目盛り数値の小数点以下桁数を設定する必要があります。</p>

<p>以下はメイングラフ領域のY軸の数値の小数点以下桁数を3に設定する例です。</p>
<pre class="highlight swift"><code><span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">designatedDecimalLength</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre>
<h3 id='' class='heading'>最大値・最小値の固定</h3>

<p>初期状態では、Y軸の最大値と最小値は表示するチャートとスクロール位置によって動的に変わりますが、Y軸の最大値と最小値を固定することができます。</p>

<p>Y軸の最大値と最小値を固定するには <code><a href="Classes/YAxis.html#/s:11TraderChart5YAxisC10lockMinMaxSbvp">YAxis.lockMinMax</a></code> プロパティを <code>true</code> に設定するか、<code>YAxis.setMinMax</code> function を <code>lock</code> 引数に <code>true</code> を指定して呼び出します。（これによりlockMinMaxがtrueに設定されます）</p>

<p>以下のコードはメイングラフ領域のY軸の最小値と最大値を0と100に固定します。</p>
<pre class="highlight swift"><code><span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="nf">setMinMax</span><span class="p">(</span><span class="nv">min</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">max</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">lock</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
</code></pre>
<h3 id='' class='heading'>タッチマーカーの表示</h3>

<p>初期状態ではY軸をタップするとタップした位置にマーカーが表示されます。</p>

<p>不要な場合は <code><a href="Classes/YAxis.html#/s:11TraderChart5YAxisC14isTouchEnabledSbvp">YAxis.isTouchEnabled</a></code> プロパティに <code>false</code> を指定することで、この機能を無効にできます。</p>
<h2 id='y' class='heading'>Y軸の目盛りのとりかた</h2>
<h3 id='' class='heading'>最大値と最小値の更新</h3>

<p>Y軸の最大値と最小値はGraphArea.chartsにセットされた <code><a href="Protocols/TechnicalChart.html">TechnicalChart</a></code> インスタンスにより更新されます。  </p>

<p><code><a href="Classes/TraderChartView.html">TraderChartView</a></code> の mainGraphArea にセットされたローソク足や単純移動平均などの組み込みテクニカル指標は、現在のスクロール位置で表示されるチャートが全て収まるように最大値と最小値を更新するため、スクロール位置を変更するとY軸の最大、最小も変化します。</p>

<p>カスタムの <code><a href="Protocols/TechnicalChart.html">TechnicalChart</a></code> を実装する場合は、<code>updateYAxis</code> ファンクション内で <code><a href="Classes/YAxis.html">YAxis</a></code> の最大値、最小値を任意に更新します。</p>
<pre class="highlight swift"><code><span class="c1">// Y軸の範囲を0〜100に設定する例</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="nf">updateYAxis</span><span class="p">(</span><span class="n">_</span> <span class="nv">yAxis</span><span class="p">:</span> <span class="kt">YAxis</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span> <span class="kt">ChartData</span><span class="p">?,</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">,</span> <span class="nv">visibleSpan</span><span class="p">:</span> <span class="kt">ClosedRange</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">yAxis</span><span class="o">.</span><span class="nf">setMinMax</span><span class="p">(</span><span class="nv">min</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">max</span><span class="p">:</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">}</span>

</code></pre>
<pre class="highlight swift"><code><span class="c1">// Y軸の範囲を画面に表示される終値の最大、最小で設定する例</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="nf">updateYAxis</span><span class="p">(</span><span class="n">_</span> <span class="nv">yAxis</span><span class="p">:</span> <span class="kt">YAxis</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span> <span class="kt">ChartData</span><span class="p">?,</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">,</span> <span class="nv">visibleSpan</span><span class="p">:</span> <span class="kt">ClosedRange</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">yAxis</span><span class="o">.</span><span class="nf">updateRangeAll</span><span class="p">(</span><span class="n">data</span><span class="p">?</span><span class="o">.</span><span class="n">closeList</span><span class="p">,</span> <span class="nv">span</span><span class="p">:</span> <span class="n">visibleSpan</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h3 id='' class='heading'>最大値と最小値を固定する</h3>

<p><code><a href="Classes/YAxis.html#/s:11TraderChart5YAxisC10lockMinMaxSbvp">YAxis.lockMinMax</a></code> プロパティを <code>true</code> にすると<code><a href="Protocols/TechnicalChart.html">TechnicalChart</a></code> インスタンスによる最大値・最小値の更新を無効にして現在設定された最大値、最小値に固定することができます。</p>
<pre class="highlight swift"><code><span class="n">chartView</span><span class="o">.</span><span class="n">mainGraphArea</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">lockMinMax</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre>
<h3 id='' class='heading'>目盛り線のとり方</h3>

<p>Y軸の目盛線と目盛りテキストが表示される位置は、Y軸の最大値と最小値の間隔により変わります。</p>

<p><code><a href="Classes/YAxis.html#/s:11TraderChart5YAxisC13minLineNumberSivp">YAxis.minLineNumber</a></code> (初期値3)の本数の目盛線が最低入り、<code><a href="Classes/YAxis.html#/s:11TraderChart5YAxisC10scaleUnitsSaySo15NSDecimalNumberCGvp">YAxis.scaleUnits</a></code> × 10のn乗となる位置に目盛線と目盛テキストが描画されます。</p>
<h2 id='' class='heading'>スクロールしない固定プロット数のチャート表示</h2>

<p>標準ではピンチイン・ピンチアウトによりX軸の刻みの間隔を拡大縮小することができますが、拡大縮小の機能を無効化し、チャート全体に表示するプロット数を固定することもできます。</p>

<p>チャート全体に表示するプロット数が常に変わらず、拡大縮小およびスクロールを行わない場合は、以下のように<code><a href="Classes/XAxis.html#/s:11TraderChart5XAxisC10fixedCountSiSgvp">XAxis.fixedCount</a></code> に固定のプロット数を設定します。</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
    <span class="c1">// チャート全体に10本のレコードが表示されるようX軸の刻み幅が決まる</span>
    <span class="n">chartView</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">fixedCount</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">}</span>
</code></pre>
<h2 id='' class='heading'>凡例の表示</h2>

<p>TraderChartViewに実装された各種テクニカル指標は、標準でグラフ領域の左上に凡例が表示されます。</p>

<p>凡例の内容は<code>TechnicalChart</code>プロトコルの<code>legend</code>ファンクションの返り値により決まりますが、移動平均など組み込みのテクニカル指標については<code>legend</code>ファンクションが実装済みのため、凡例をカスタマイズするための<code>customLegend</code>プロパティがあります。</p>

<p>組み込みのテクニカル指標については、<code>customLegend</code>プロパティに凡例を作成するファンクションをセットすることで凡例の内容を任意に変更することができます。</p>

<p>以下はSMA（移動平均）の凡例をカスタマイズし、タップして選択した位置の移動平均の値を凡例に表示する例です。</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
    <span class="n">chartView</span><span class="o">.</span><span class="n">sma</span><span class="o">.</span><span class="n">customLegend</span> <span class="o">=</span> <span class="n">customSMALegend</span>
<span class="p">}</span>

<span class="kd">private</span> <span class="kd">func</span> <span class="nf">customSMALegend</span><span class="p">(</span><span class="nv">sma</span><span class="p">:</span> <span class="kt">SMA</span><span class="p">,</span> <span class="nv">selectedIndex</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Legend</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">index</span> <span class="o">=</span> <span class="n">selectedIndex</span> <span class="p">??</span> <span class="p">(</span><span class="n">sma</span><span class="o">.</span><span class="n">shortSMA</span><span class="p">?</span><span class="o">.</span><span class="n">count</span> <span class="p">??</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">let</span> <span class="nv">short</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">shortSMA</span><span class="p">?[</span><span class="n">index</span><span class="p">]?</span><span class="o">.</span><span class="nf">stringValue</span><span class="p">(</span><span class="nv">decimalLength</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="p">??</span> <span class="s">""</span>
    <span class="k">let</span> <span class="nv">middle</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">middleSMA</span><span class="p">?[</span><span class="n">index</span><span class="p">]?</span><span class="o">.</span><span class="nf">stringValue</span><span class="p">(</span><span class="nv">decimalLength</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="p">??</span> <span class="s">""</span>
    <span class="k">let</span> <span class="nv">long</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">longSMA</span><span class="p">?[</span><span class="n">index</span><span class="p">]?</span><span class="o">.</span><span class="nf">stringValue</span><span class="p">(</span><span class="nv">decimalLength</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="p">??</span> <span class="s">""</span>
    <span class="k">return</span> <span class="kt">Legend</span><span class="p">([</span>
        <span class="kt">ColorText</span><span class="p">(</span><span class="s">"移動平均:</span><span class="se">\(</span><span class="n">short</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="n">sma</span><span class="o">.</span><span class="n">shortColor</span><span class="p">,</span> <span class="nv">visible</span><span class="p">:</span> <span class="n">sma</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">shortOn</span><span class="p">),</span>
        <span class="kt">ColorText</span><span class="p">(</span><span class="s">"移動平均:</span><span class="se">\(</span><span class="n">middle</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="n">sma</span><span class="o">.</span><span class="n">middleColor</span><span class="p">,</span> <span class="nv">visible</span><span class="p">:</span> <span class="n">sma</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">middleOn</span><span class="p">),</span>
        <span class="kt">ColorText</span><span class="p">(</span><span class="s">"移動平均:</span><span class="se">\(</span><span class="n">long</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="n">sma</span><span class="o">.</span><span class="n">longColor</span><span class="p">,</span> <span class="nv">visible</span><span class="p">:</span> <span class="n">sma</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">longOn</span><span class="p">),</span>
    <span class="p">])</span>
<span class="p">}</span>
</code></pre>
<h2 id='uiscrollview-chartview' class='heading'>UIScrollViewにChartViewを配置する</h2>

<p>UIScrollViewにChartViewを配置した場合、UIScrollViewのスクロールが優先されるためChartViewのタッチ操作は正常に動作しなくなります。<br>
この問題を回避するには、<code>ChartView.setParentScrollView</code> functionを実行します。</p>
<pre class="highlight swift"><code><span class="c1">// Y座標が300以上の場合scrollViewのスクロールを有効にし、それ以外はChartViewのタッチ操作を有効にする例</span>
<span class="n">chartView</span><span class="o">.</span><span class="nf">setParentScrollView</span><span class="p">(</span><span class="n">scrollView</span><span class="p">,</span> <span class="nv">canScrollParent</span><span class="p">:</span> <span class="p">{</span> <span class="n">touchPoint</span> <span class="k">in</span>
    <span class="k">return</span> <span class="mi">300</span> <span class="o">&lt;=</span> <span class="n">touchPoint</span><span class="o">.</span><span class="n">y</span>
<span class="p">})</span>
</code></pre>

<p>このfunctionを実行すると、引数で渡したUIScrollViewの <code>delaysContentTouches</code> は <code>false</code> に設定され、ChartView以外のボタンなどのUIのタッチにも影響があることに注意してください。</p>
<h2 id='technicalchart' class='heading'>カスタムTechnicalChartの実装</h2>

<p>TechnicalChartプロトコルを実装したクラスを作成すれば、任意の指標を追加することができます。また、TechnicalChartプロトコルに必要なファンクションの空実装を持った<code><a href="Classes/SimpleTechnicalChart.html">SimpleTechnicalChart</a></code> クラスを継承したクラスを作成しても任意の指標を作成することができます。</p>

<p>TechnicalChartプロトコルには以下のファンクションを実装する必要があります。</p>
<h3 id='var-isvisible' class='heading'>var isVisible</h3>

<p>表示/非表示を切り替えます。単純なBoolのプロパティの実装で問題ありません。</p>
<h3 id='strong-func-strong-legend-selectedindex-int-gt-legend' class='heading'><strong>func</strong> legend(selectedIndex: Int?) -&gt; Legend?</h3>

<p>凡例（Legend）を表示する場合は任意の凡例（Legend）オブジェクトを返します。</p>
<h3 id='strong-func-strong-updatedata-strong-_-strong-data-chartdata-updatedfrom-int' class='heading'><strong>func</strong> updateData(<strong>_</strong> data: ChartData?, updatedFrom: Int?)</h3>

<p>チャートデータが更新された場合に呼ばれます。</p>

<p>テクニカル指標が計算結果を保持する場合は、このファンクション内で指標を計算します。</p>
<h3 id='strong-func-strong-updateyaxis-strong-_-strong-yaxis-yaxis-data-chartdata-height-cgfloat-visiblespan-closedrange-int' class='heading'><strong>func</strong> updateYAxis(<strong>_</strong> yAxis: YAxis, data: ChartData?, height: CGFloat, visibleSpan: ClosedRange<Int>)</h3>

<p>Y軸の範囲（最大・最小）を更新します。Y軸の範囲は大きく分けてスクロール位置によって変わる場合と変わらない場合があり、それぞれのコードサンプルを以下に記載します。</p>

<p>スクロール位置によらずY軸を0〜100に固定する場合</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">updateYAxis</span><span class="p">(</span><span class="n">_</span> <span class="nv">yAxis</span><span class="p">:</span> <span class="kt">YAxis</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span> <span class="kt">ChartData</span><span class="p">?,</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">,</span> <span class="nv">visibleSpan</span><span class="p">:</span> <span class="kt">ClosedRange</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">yAxis</span><span class="o">.</span><span class="nf">setMinMax</span><span class="p">(</span><span class="nv">min</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">max</span><span class="p">:</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>現在のスクロール位置で表示される終値が全ておさまる範囲にする場合</p>
<pre class="highlight swift"><code><span class="kd">open</span> <span class="k">override</span> <span class="kd">func</span> <span class="nf">updateYAxis</span><span class="p">(</span><span class="n">_</span> <span class="nv">yAxis</span><span class="p">:</span> <span class="kt">YAxis</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span> <span class="kt">ChartData</span><span class="p">?,</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">,</span> <span class="nv">visibleSpan</span><span class="p">:</span> <span class="kt">ClosedRange</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">yAxis</span><span class="o">.</span><span class="nf">updateRangeAll</span><span class="p">(</span><span class="n">data</span><span class="p">?</span><span class="o">.</span><span class="n">closeList</span><span class="p">,</span> <span class="nv">span</span><span class="p">:</span> <span class="n">visibleSpan</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h3 id='strong-func-strong-updatexaxis-strong-_-strong-xaxis-xaxis-data-chartdata' class='heading'><strong>func</strong> updateXAxis(<strong>_</strong> xAxis: XAxis, data: ChartData?)</h3>

<p>X軸の範囲を更新します。実装するテクニカル指標によりX軸の表示を変える必要がある場合は <code>xAxis.dataList</code> を更新します。</p>
<h3 id='strong-func-strong-clear' class='heading'><strong>func</strong> clear()</h3>

<p>計算結果を保持する場合は、このファンクションでクリアします。<code><a href="Classes/ChartView.html#/s:11TraderChart0B4ViewC5clearyyF">ChartView.clear()</a></code> ファンクションなどで呼び出されます。</p>
<h3 id='strong-func-strong-onparameterchanged' class='heading'><strong>func</strong> onParameterChanged()</h3>

<p>パラメータが変更されたことを通知するファンクションです。<code><a href="Classes/ChartView.html#/s:11TraderChart0B4ViewC22refrectParameterChangeyyF">ChartView.refrectParameterChange()</a></code> から呼び出されます。</p>

<p>パラメータが変更可能なテクニカル指標の場合、計算済み指標に使ったパラメータを保持しておき、このファンクションで変更されたパラメータに基づく計算結果を削除する必要があります。</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="http://altonotes.co.jp/" target="_blank" rel="external">altonotes</a>. All rights reserved. (Last updated: 2019-07-29)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.10.0</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
